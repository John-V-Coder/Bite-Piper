{% extends 'funding/base.html' %}

{% block title %}AI Agent Dashboard{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- Header -->
    <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg shadow-2xl p-8 mb-8">
        <h1 class="text-4xl font-bold mb-2 flex items-center">
            <span class="mr-4"></span>
            AI Agent Dashboard
        </h1>
        <p class="text-purple-100 text-lg">
            Monitor and interact with the Bite-Piper civic decision-making agent.
        </p>
    </div>

    <!-- Main Dashboard Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

        <!-- Left Column -->
        <div class="lg:col-span-1 space-y-8">
            
            <!-- Agent Status Card -->
            <div class="bg-white rounded-lg shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-2xl font-semibold text-gray-800 flex items-center">
                        <span class="mr-3 text-3xl"></span>
                        Agent Status
                    </h2>
                </div>
                <div 
                    class="p-6"
                    hx-get="{% url 'funding:agent_health' %}"
                    hx-trigger="load, every 10s"
                    hx-swap="innerHTML"
                >
                    <!-- Agent status will load here -->
                    <div class="flex items-center justify-center py-8">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"></div>
                        <span class="ml-4 text-gray-600">Connecting to agent...</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions Card -->
            <div class="bg-white rounded-lg shadow-lg p-6 hover:shadow-2xl transition-shadow duration-300">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 border-b pb-4 flex items-center">
                    <span class="mr-3 text-3xl"></span>
                    Quick Actions
                </h2>
                <div class="space-y-4">
                    <a href="{% url 'funding:index' %}" class="block w-full text-left bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg p-4 hover:shadow-xl transition-shadow">
                        <div class="font-semibold text-lg">Funding Dashboard</div>
                        <div class="text-sm text-purple-100 mt-1">Calculate & analyze allocations</div>
                    </a>
                    <button 
                        onclick="window.location.reload()"
                        class="w-full text-left bg-gradient-to-r from-green-500 to-teal-500 text-white rounded-lg p-4 hover:shadow-xl transition-shadow"
                    >
                        <div class="font-semibold text-lg">Refresh Page</div>
                        <div class="text-sm text-green-100 mt-1">Force a full refresh</div>
                    </button>
                    <a href="{% url 'funding:about' %}" class="block w-full text-left bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-lg p-4 hover:shadow-xl transition-shadow">
                        <div class="font-semibold text-lg">About System</div>
                        <div class="text-sm text-blue-100 mt-1">Learn more about BITE-PIPER</div>
                    </a>
                </div>
            </div>

        </div>

        <!-- Right Column -->
        <div class="lg:col-span-2">

            <!-- Agent Capabilities Card -->
            <div class="bg-white rounded-lg shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <div class="p-6 border-b border-gray-200">
                    <h2 class="text-2xl font-semibold text-gray-800 flex items-center">
                        <span class="mr-3 text-3xl">ðŸŽ¯</span>
                        Agent Capabilities
                    </h2>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Fairness Analysis -->
                        <div class="border-l-4 border-purple-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Fairness Analysis</h3>
                            <p class="text-gray-600 mt-1">Evaluates allocation fairness using distributive justice principles.</p>
                        </div>
                        <!-- Justice Evaluation -->
                        <div class="border-l-4 border-blue-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Justice Evaluation</h3>
                            <p class="text-gray-600 mt-1">Applies ethical frameworks to evaluate decision fairness.</p>
                        </div>
                        <!-- Equity Analysis -->
                        <div class="border-l-4 border-green-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Equity Analysis</h3>
                            <p class="text-gray-600 mt-1">Identifies and addresses systemic inequities in distribution.</p>
                        </div>
                        <!-- Impact Assessment -->
                        <div class="border-l-4 border-yellow-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Impact Assessment</h3>
                            <p class="text-gray-600 mt-1">Quantifies the impact of allocation decisions on communities.</p>
                        </div>
                        <!-- Transparency Engine -->
                        <div class="border-l-4 border-indigo-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Transparency Engine</h3>
                            <p class="text-gray-600 mt-1">Generates clear, understandable explanations for all decisions.</p>
                        </div>
                        <!-- Bias Detection -->
                        <div class="border-l-4 border-red-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Bias Detection</h3>
                            <p class="text-gray-600 mt-1">Identifies potential systemic biases in decision-making.</p>
                        </div>
                        <!-- Policy Analysis -->
                        <div class="border-l-4 border-pink-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Policy Analysis</h3>
                            <p class="text-gray-600 mt-1">Evaluates policies for compliance, effectiveness, and ethics.</p>
                        </div>
                        <!-- Stakeholder Mediation -->
                        <div class="border-l-4 border-orange-400 pl-4">
                            <h3 class="text-xl font-bold text-gray-800">Stakeholder Mediation</h3>
                            <p class="text-gray-600 mt-1">Facilitates conflict resolution and consensus building.</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>

<script>
// This script can be used for more advanced interactivity if needed in the future.
document.addEventListener('htmx:afterSwap', function(event) {
    // Example: log when the agent health check content is swapped
    if (event.detail.target.closest('[hx-get*="agent_health"]')) {
        console.log('Agent status updated via HTMX.');
    }
});
</script>
{% endblock %}